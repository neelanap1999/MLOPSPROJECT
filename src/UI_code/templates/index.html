<!DOCTYPE html>
<html>
<head>
    <title>MLOps Sample Selection</title>
    <style>
        body {
            background-color: #f5f5f5; /* Professional background color */
            text-align: center;
            font-family: Arial, sans-serif;
        }

        h1 {
            margin: 50px 0;
            font-size: 50px;
        }

        h2 {
            margin: 40px 0;
            font-size: 36px;
        }


        table {
            border-collapse: collapse;
            margin: auto;
            width: 80%;  /* Adjust width as needed */
        }

        th, td {
            border: 1px solid #ddd;
            padding: 4px;  /* Reduce padding for potentially long content */
            white-space: nowrap;  /* Prevent text wrapping within cells */
            /*text-overflow: ellipsis;*/  /* Truncate long content with ellipsis (...) */
        }

        th {
            background-color: #eee;
        }

        /* Custom styles for buttons */
        .button {
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 10px 24px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 8px;
        }

        /* Custom styles for Predict button */
        .predict-button {
            background-color: #f44336; /* Red */
        }

        /* Custom styles for image */
        .credit-risk-assessment-image {
            width: 100px;
            height: auto;
            margin-bottom: 20px;
        }

        /* Custom styles for dropdown */
        select {
            width: 200px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            /* appearance: none; *//* Remove default dropdown arrow */
            /*-webkit-appearance: none;*/
            /*-moz-appearance: none;*/
            background-color: #fff;
            /*background-image: url('arrow.png');*/ /* Add custom dropdown arrow */
            background-position: right center;
            background-repeat: no-repeat;
            cursor: pointer;
        }

        /* Add hover effect to dropdown */
        select:hover {
            border-color: #999;
        }
    </style>
</head>
<body>
    <h1>Credit Risk Assessment</h1>
    <form action="/" id="sampleForm">
        <select name="selected_file" id="selectedFile">
            {% for file in selected_file_options %}
                {% set sample_number = file.split('_')[1].split('.')[0] %}
                <option value="{{ file }}" {% if selected_file == file %}selected{% endif %}>Sample {{ sample_number }}</option>
            {% endfor %}
        </select>
    </form>

    {% if sample_data %}
        <h2>Sample Test Data </h2>
        <table>
            <thead>
                <tr>
                    {% for label in column_labels %}
                        <th>{{ label }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in sample_data %}
                    <tr>
                        {% for value in row %}
                            <td>{{ value }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <br>
        <button onclick="generateSamples()" class="button">Generate New Samples</button>
        <button onclick="predict()" class="button predict-button">Predict</button> <!-- New Predict button -->
    {% endif %}

    <script>
        document.getElementById('selectedFile').addEventListener('change', function() {
            document.getElementById('sampleForm').submit();
        });

        function displayPopup(message) {
            alert(message); // Display popup alert
        }

        function generateSamples() {
            // Make an AJAX request to Flask route for generating new samples
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/generate_new_samples", true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                    // Display popup when new samples are generated
                    displayPopup("New samples generated!");
                    // Reload the page to fetch and display the updated data
                    location.reload();
                }
            };
            xhr.send();
        }


        function predict() {
            // Get the selected sample file from the dropdown
            var selectedFile = document.querySelector('select[name="selected_file"]').value;

            // Make an AJAX request to Flask route for predicting
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/predict?selected_file=" + encodeURIComponent(selectedFile), true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        displayPopup("Predict data saved as predict_data.json");
                    } else {
                        displayPopup("Error occurred while predicting!");
                    }
                }
            };
            xhr.send();
        }
    </script>
</body>
</html>
